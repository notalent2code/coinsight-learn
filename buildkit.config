# Docker BuildKit Configuration
# This file optimizes Docker builds for the microservices project

# Enable BuildKit globally
export DOCKER_BUILDKIT=1
export COMPOSE_DOCKER_CLI_BUILD=1

# BuildKit advanced features
export BUILDKIT_PROGRESS=plain
export BUILDKIT_COLORS=1

# Cache configuration
export BUILDKIT_CACHE_MOUNT_NS=coinsight-maven-cache

# Multi-platform build support (optional)
# export DOCKER_CLI_EXPERIMENTAL=enabled

# Memory limits for builds (adjust based on your system)
export BUILDKIT_STEP_LOG_MAX_SIZE=50000000
export BUILDKIT_STEP_LOG_MAX_SPEED=100000

# Parallel build settings
export COMPOSE_PARALLEL_LIMIT=3

echo "ðŸ”§ BuildKit configuration loaded:"
echo "   â€¢ BuildKit: $DOCKER_BUILDKIT"
echo "   â€¢ Progress: $BUILDKIT_PROGRESS"
echo "   â€¢ Cache namespace: $BUILDKIT_CACHE_MOUNT_NS"
echo "   â€¢ Parallel limit: $COMPOSE_PARALLEL_LIMIT"
